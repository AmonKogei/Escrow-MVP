{"file":"C:\\Users\\USER\\Downloads\\Escrow MVP\\tests (Simplified for brevity)\\session.test.ts","mappings":";;AAAA,gDAAgE;AAEhE,QAAQ,CAAC,iBAAiB,EAAE,GAAG,EAAE;IAC/B,MAAM,MAAM,GAAG,aAAa,CAAC;IAC7B,EAAE,CAAC,4BAA4B,EAAE,KAAK,IAAI,EAAE;QAC1C,MAAM,OAAO,GAAG,EAAE,EAAE,EAAE,IAAI,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC;QAC5C,MAAM,MAAM,GAAG,MAAM,IAAA,qBAAW,EAAC,OAAO,EAAE,MAAM,CAAC,CAAC;QAClD,MAAM,CAAC,OAAO,MAAM,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;QACrC,MAAM,MAAM,GAAG,MAAM,IAAA,uBAAa,EAAC,MAAM,EAAE,MAAM,CAAC,CAAC;QACnD,MAAM,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;IAClC,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,2BAA2B,EAAE,KAAK,IAAI,EAAE;QACzC,MAAM,OAAO,GAAG,EAAE,EAAE,EAAE,IAAI,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC;QAC5C,MAAM,MAAM,GAAG,MAAM,IAAA,qBAAW,EAAC,OAAO,EAAE,MAAM,CAAC,CAAC;QAClD,SAAS;QACT,MAAM,QAAQ,GAAG,MAAM,CAAC,OAAO,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;QAClD,MAAM,MAAM,GAAG,MAAM,IAAA,uBAAa,EAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;QACrD,MAAM,CAAC,MAAM,CAAC,CAAC,QAAQ,EAAE,CAAC;IAC5B,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","names":[],"sources":["C:\\Users\\USER\\Downloads\\Escrow MVP\\tests (Simplified for brevity)\\session.test.ts"],"sourcesContent":["import { signSession, verifySession } from '../src/lib/session';\r\n\r\ndescribe('session helpers', () => {\r\n  const secret = 'test-secret';\r\n  it('signs and verifies payload', async () => {\r\n    const payload = { id: 'u1', role: 'ADMIN' };\r\n    const signed = await signSession(payload, secret);\r\n    expect(typeof signed).toBe('string');\r\n    const parsed = await verifySession(signed, secret);\r\n    expect(parsed).toEqual(payload);\r\n  });\r\n\r\n  it('rejects invalid signature', async () => {\r\n    const payload = { id: 'u1', role: 'ADMIN' };\r\n    const signed = await signSession(payload, secret);\r\n    // Tamper\r\n    const tampered = signed.replace('ADMIN', 'BUYER');\r\n    const parsed = await verifySession(tampered, secret);\r\n    expect(parsed).toBeNull();\r\n  });\r\n});\r\n"],"version":3}